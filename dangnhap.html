<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Đăng Nhập - Shop Eirlyst</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=Inter:wght@400;500;600;700;800;900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div class="login-container">
      <div class="welcome-section">
        <div class="content-wrapper">
          <img src="florist1_.png" alt="Florist" class="florist-inline" />
          <h1>Shop Eirlyst</h1>
          <p>Hoa tươi mỗi ngày<br />Giao hàng tận nơi</p>
          <button
            class="register-btn"
            onclick="window.location.href='register.html'"
          >
            Đăng Ký Ngay
          </button>
        </div>
      </div>

      <div class="login-section">
        <h2>Đăng Nhập</h2>
        <p class="subtitle">Chào mừng quý khách trở lại</p>

        <form onsubmit="return false;">
          <p>Tài khoản</p>
          <div class="form-group">
            <input id="username" type="text" placeholder="Tên đăng nhập" />
            <i class="fas fa-user icon"></i>
          </div>
          <p>Mật khẩu</p>
          <div class="form-group">
            <input id="password" type="password" placeholder="Mật khẩu" />
            <i class="fas fa-lock icon"></i>
          </div>

          <!-- forgot-password removed -->

          <button type="button" class="login-btn" onclick="handleLogin()">
            Đăng Nhập
          </button>
        </form>

        <div class="divider">
          <span>hoặc đăng nhập với</span>
        </div>

        <div class="social-login">
          <div class="social-btn google" title="Google">
            <i class="fab fa-google"></i>
          </div>
          <div class="social-btn facebook" title="Facebook">
            <i class="fab fa-facebook-f"></i>
          </div>
          <div class="social-btn github" title="GitHub">
            <i class="fab fa-github"></i>
          </div>
          <div class="social-btn linkedin" title="LinkedIn">
            <i class="fab fa-linkedin-in"></i>
          </div>
        </div>
      </div>
      <script>
        // Login: check stored accounts in localStorage, keep legacy demo account for compatibility
        function handleLogin() {
          const username = document.getElementById('username').value.trim();
          const password = document.getElementById('password').value;

          const legacyUser = { username: 'nguoidung1', password: 'mahoa123' };

          let authenticated = false;

          try {
            const accounts = JSON.parse(localStorage.getItem('floralShopAccounts') || '[]');
            if (accounts && accounts.find(a => a.username === username && a.password === password)) {
              authenticated = true;
            }
          } catch (e) {
            console.error('Error reading accounts', e);
          }

          // Fallback to legacy demo credentials
          if (!authenticated && username === legacyUser.username && password === legacyUser.password) {
            authenticated = true;
          }

          if (authenticated) {
            localStorage.setItem('floralShopUser', JSON.stringify({ username }));

            const params = new URLSearchParams(window.location.search);
            const next = params.get('next');
            if (next) {
              try {
                window.location.href = decodeURIComponent(next);
                return;
              } catch (e) {
                // ignore and continue to index
              }
            }

            window.location.href = 'index.html';
          } else {
            alert('Tài khoản hoặc mật khẩu không đúng. Vui lòng thử lại.');
          }
        }

        // Prefill username if redirected from register.html?user=...
        document.addEventListener('DOMContentLoaded', () => {
          const params = new URLSearchParams(window.location.search);
          const pre = params.get('user');
          if (pre) {
            const input = document.getElementById('username');
            if (input) input.value = pre;
          }
        });
      </script>
    </div>
  </body>
</html>
